!function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}};e.d({},{Mm:function(){return C},hi:function(){return S},YS:function(){return I},vV:function(){return b},eY:function(){return y},X0:function(){return q}});const t=document.querySelector(".profile__edit-link"),r=document.querySelector(".profile__add-link"),n=document.querySelector(".profile__image-button"),o=document.querySelector("#add-card-modal").querySelector(".modal__form"),s=document.querySelector("#profile-modal").querySelector(".modal__form"),i=document.querySelector("#avatar-modal").querySelector(".modal__form"),a=document.querySelector("#card-template").content.firstElementChild,l={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:".modal__input-error_",errorClass:"modal__input_border_red"};class d{constructor(e,t){this._validationConfig=e,this._formElement=t,this._buttonElement=this._formElement.querySelector(this._validationConfig.submitButtonSelector)}_showInputError(e,t){const r=this._formElement.querySelector(this._validationConfig.inputErrorClass+e.id);e.classList.add(this._validationConfig.errorClass),r.textContent=t}_hideInputError(e){const t=this._formElement.querySelector(this._validationConfig.inputErrorClass+e.id);e.classList.remove(this._validationConfig.errorClass),t.textContent=""}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(e,t){this._hasInvalidInput(e)?this.disableStateButton():(t.classList.remove(this._validationConfig.inactiveButtonClass),t.removeAttribute("disabled"))}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._validationConfig.inputSelector));this._toggleButtonState(e,this._buttonElement),e.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState(e,this._buttonElement)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}disableStateButton(){this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._validationConfig.inactiveButtonClass)}}class c{constructor(e,t,r){this._data=e,this._cardElement=t.cloneNode(!0),this._handleImageClick=r}_setEventListeners(){this._cardElement.querySelector(".card__link").addEventListener("click",(()=>{this._handleLikeButton()})),this._cardElement.querySelector(".card__delete-btn").addEventListener("click",(()=>{const e=new h({popupSelector:"#delete-card-modal",handleYesButton:()=>{S.deleteCard(this._data._id),this._handleDeleteCard()}});e.open(),e.setEventListeners()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this._data)}))}_handleDeleteCard(){this._cardElement.remove()}_handleLikeButton(){this._data.isLiked?(S.deleteLike(this._data._id,this._cardElement),this._data.isLiked=!1):(S.addLike(this._data._id,this._cardElement),this._data.isLiked=!0)}returnCardElement(){return this._cardElement.querySelector(".card__image").src=this._data.link,this._cardElement.querySelector(".card__title").textContent=this._data.name,this._cardElement.querySelector(".card__image").alt=this._data.name,this._setEventListeners(),this._cardElement}}class u{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClick(e){e.target===e.currentTarget&&this.close()}setEventListeners(){this._popupElement.querySelector(".modal__close-button-container").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("mousedown",(e=>{this._handleRemoteClick(e)}))}}class _ extends u{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._handleFormSubmit=r}close(){this._popupForm.reset(),super.close()}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.id]=e.value})),this._formValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.id]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}class h extends u{constructor(e){let{popupSelector:t,handleYesButton:r}=e;super({popupSelector:t}),this._handleYesButton=r,this._popupButton=this._popupElement.querySelector(".modal__button")}setEventListeners(){super.setEventListeners(),this._popupButton.addEventListener("click",(e=>{e.preventDefault(),this._handleYesButton(),this.close()}))}}function m(e){b.open(e)}function p(e){return new d(l,e)}function E(e,t){return new _({popupSelector:e,handleFormSubmit:t})}function f(e){return new c(e,a,m).returnCardElement()}class v{constructor(e,t){let{items:r,renderer:n}=e;this._initialArray=r,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}appendItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}const S=new class{constructor(){this._baseUrl="https://around-api.en.tripleten-services.com/v1",this._headers={authorization:"4c45d989-e1aa-4bb6-a467-6ac9c46f3dac","Content-Type":"application/json"},this._headers1={authorization:"4c45d989-e1aa-4bb6-a467-6ac9c46f3dac"}}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers1}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{y.setUserInfo(e),document.querySelector(".profile__image").src=e.avatar,console.log(e)})).catch((e=>{console.error(e)}))}loadCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers1}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{const t=new v({items:e,renderer:e=>{const r=f(e);e.isLiked?r.querySelector(".card__love-icon").classList.add("card__love-icon_background_black"):r.querySelector(".card__love-icon").classList.remove("card__love-icon_background_black"),t.appendItem(r)}},".elements");t.renderItems()})).catch((e=>{console.error(e)}))}editProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{y.setUserInfo(e)})).catch((e=>{console.error(e)})).finally((()=>{this.renderLoading(!1)}))}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{const t=f({name:e.name,link:e.link,_id:e._id});document.querySelector(".elements").prepend(t),formValidatorCardModal.disableStateButton()})).catch((e=>console.error(e))).finally((()=>{this.renderLoading(!1)}))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers1}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}addLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers1}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{e.isLiked&&t.querySelector(".card__love-icon").classList.add("card__love-icon_background_black")})).catch((e=>{console.error(e)}))}deleteLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers1}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{e.isLiked||t.querySelector(".card__love-icon").classList.remove("card__love-icon_background_black")})).catch((e=>{console.error(e)}))}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).then((e=>{document.querySelector(".profile__image").src=e.avatar,console.log(e)})).catch((e=>console.error(e))).finally((()=>{this.renderLoading(!1)}))}renderLoading(e){document.querySelector(".modal__button").textContent=e?"Saving...":"Save"}};S.loadUserInfo(),S.loadCards();const b=new class extends u{open(e){this._popupElement.querySelector(".modal__image").src=e.link,this._popupElement.querySelector(".modal__image").alt=e.link,this._popupElement.querySelector(".modal__caption").textContent=e.name,super.open()}}({popupSelector:"#card-modal"}),y=new class{constructor(e){let{nameSelector:t,jobSelector:r}=e;this._userName=document.querySelector(t),this._userJob=document.querySelector(r)}getUserInfo(){return this._userInfo={},this._userInfo.name=this._userName.textContent,this._userInfo.about=this._userJob.textContent,this._userInfo}setUserInfo(e){this._userName.textContent=e.name,this._userJob.textContent=e.about}}({nameSelector:".profile__name",jobSelector:".profile__description"}),L=p(s),k=p(o),g=p(i),C=E("#add-card-modal",(e=>{S.renderLoading(!0),S.addNewCard(e)})),q=E("#profile-modal",(e=>{S.renderLoading(!0),S.editProfile(e)})),I=E("#avatar-modal",(e=>{S.renderLoading(!0),S.updateProfilePicture(e)}));L.enableValidation(),k.enableValidation(),g.enableValidation(),C.setEventListeners(),q.setEventListeners(),I.setEventListeners(),b.setEventListeners(),t.addEventListener("click",(function(){q.open(),q.setInputValues(y.getUserInfo())})),r.addEventListener("click",(function(){C.open()})),n.addEventListener("click",(function(){I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SixVQUFVeEksWUFBY3lILEVBQVl4RSxLQUN6QzVELEtBQUtvSixTQUFTekksWUFBY3lILEVBQVltQixLQUM1QyxHUlNvQixDQUFDTixhSEVBLGlCR0Y0QkMsWUhHckIsMEJRZDFCTSxFQUE0QmpFLEVBQW9CdEcsR0FDaEQ0SixFQUF5QnRELEVBQW9CdkcsR0FDN0N5SyxFQUEyQmxFLEVBQW9CckcsR0FDL0N3SyxFQUFnQmpFLEVBQW9CLG1CQUFvQjJDLElBQzVEcEYsRUFBSTJGLGVBQWMsR0FDbEIzRixFQUFJNEYsV0FBV1IsRUFBWSxJQUV2QnVCLEVBQWdCbEUsRUFBb0Isa0JBQW1CMkMsSUFDM0RwRixFQUFJMkYsZUFBYyxHQUNsQjNGLEVBQUltRixZQUFZQyxFQUFZLElBRXhCd0IsRUFBY25FLEVBQW9CLGlCQUFrQjJDLElBQ3hEcEYsRUFBSTJGLGVBQWMsR0FDbEIzRixFQUFJK0YscUJBQXFCWCxFQUFZLElBUXZDb0IsRUFBMEJ6SCxtQkFDMUI4RyxFQUF1QjlHLG1CQUN2QjBILEVBQXlCMUgsbUJBQ3pCMkgsRUFBY3JHLG9CQUNkc0csRUFBY3RHLG9CQUNkdUcsRUFBWXZHLG9CQUNaaUMsRUFBV2pDLG9CQUNYMUUsRUFBV21ELGlCQUFpQixTTC9CNUIsV0FDSTZILEVBQWN2RyxPQUNkdUcsRUFBY3pFLGVBQWVxQyxFQUFTOEIsY0FDMUMsSUs2QkF2SyxFQUFlZ0QsaUJBQWlCLFNMM0JoQyxXQUNJNEgsRUFBY3RHLE1BQ2xCLElLMEJBckUsRUFBYStDLGlCQUFpQixTTHhCOUIsV0FDSThILEVBQVl4RyxNQUNoQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoWWVzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgZGVmaW5pdGlvbikge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9IiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICAgIHtcbiAgICAgIG5hbWU6ICdZb3NlbWl0ZSBWYWxsZXknLFxuICAgICAgbGluazogJ2h0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdMYWtlIExvdWlzZScsXG4gICAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGcnLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ0JhbGQgTW91bnRhaW5zJyxcbiAgICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZycsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnTGF0ZW1hcicsXG4gICAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZycsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnVmFub2lzZSBOYXRpb25hbCBQYXJrJyxcbiAgICAgIGxpbms6ICdodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdMYWdvIGRpIEJyYWllcycsXG4gICAgICBsaW5rOiAnaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZycsXG4gICAgfVxuXTtcblxuLy8gIEJVVFRPTlNcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1saW5rJyk7XG5jb25zdCBwcm9maWxlTmFtZUNsYXNzID0gJy5wcm9maWxlX19uYW1lJztcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkNsYXNzID0gJy5wcm9maWxlX19kZXNjcmlwdGlvbic7XG5jb25zdCBhZGRQbGFjZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtbGluaycpO1xuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlLWJ1dHRvbicpO1xuXG4vLyBDQVJEIE1PREFMXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLWNhcmQtbW9kYWwnKTtcbmNvbnN0IGNhcmRNb2RhbEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJyk7XG5cbi8vIFBST0ZJTEUgTU9EQUxcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLW1vZGFsJyk7XG5jb25zdCBwcm9maWxlTW9kYWxGb3JtID0gcHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZm9ybScpO1xuXG4vL0FWQVRBUiBNT0RBTFxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXZhdGFyLW1vZGFsJyk7XG5jb25zdCBhdmF0YXJNb2RhbEZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Zvcm0nKTtcblxuLy8gQ0FSRFNcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmNvbnN0IGNhcmRDb250YWluZXJDbGFzcyA9ICcuZWxlbWVudHMnO1xuXG4vL0ZPUk0gVkFMSURBVElPTlxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2luYWN0aXZlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCIubW9kYWxfX2lucHV0LWVycm9yX1wiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9ib3JkZXJfcmVkXCJcbn07XG5cbmV4cG9ydCB7aW5pdGlhbENhcmRzLCBlZGl0QnV0dG9uLCBwcm9maWxlTmFtZUNsYXNzLCBwcm9maWxlRGVzY3JpcHRpb25DbGFzcywgYWRkUGxhY2VCdXR0b24sIGNhcmRNb2RhbEZvcm0sIGF2YXRhck1vZGFsRm9ybSwgcHJvZmlsZU1vZGFsRm9ybSwgY2FyZFRlbXBsYXRlLCBjYXJkQ29udGFpbmVyQ2xhc3MsIHZhbGlkYXRpb25Db25maWcsIGF2YXRhckJ1dHRvbn07IiwiLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAgICAgICAgRlVOQ1RJT05TICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9ye1xuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uQ29uZmlnLCBmb3JtRWxlbWVudCl7XG4gICAgdGhpcy5fdmFsaWRhdGlvbkNvbmZpZyA9IHZhbGlkYXRpb25Db25maWc7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl92YWxpZGF0aW9uQ29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSl7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl92YWxpZGF0aW9uQ29uZmlnLmlucHV0RXJyb3JDbGFzcyArIGlucHV0RWxlbWVudC5pZCk7XG4gIFxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3ZhbGlkYXRpb25Db25maWcuZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpe1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdmFsaWRhdGlvbkNvbmZpZy5pbnB1dEVycm9yQ2xhc3MgKyBpbnB1dEVsZW1lbnQuaWQpO1xuICBcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl92YWxpZGF0aW9uQ29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3Qpe1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZShpbnB1dEVsZW1lbnQgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSlcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCl7XG4gICAgaWYoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCl7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9O1xuXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpe1xuICAgIGlmKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKXtcbiAgICAgIHRoaXMuZGlzYWJsZVN0YXRlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl92YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfVxuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycygpe1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl92YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcbiAgXG4gICAgaW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCl7XG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSk7XG4gIFxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGRpc2FibGVTdGF0ZUJ1dHRvbigpe1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl92YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59OyIsIiAgaW1wb3J0IHsgY3JlYXRlUG9wdXBXaXRoWWVzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG4gIGltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9wYWdlcy9pbmRleC5qc1wiO1xuICBcbiAgZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZHtcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spe1xuICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGNhcmRTZWxlY3Rvci5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB9XG4gIFxuICAgIF9zZXRFdmVudExpc3RlbmVycygpe1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpbmsnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBkZWxldGVDYXJkUG9wdXAgPSBjcmVhdGVQb3B1cFdpdGhZZXMoJyNkZWxldGUtY2FyZC1tb2RhbCcsICgpID0+IHtcbiAgICAgICAgICBhcGkuZGVsZXRlQ2FyZCh0aGlzLl9kYXRhLl9pZCk7XG4gICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XG4gICAgICB9KTtcbiAgICB9XG4gIFxuICAgIF9oYW5kbGVEZWxldGVDYXJkKCl7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG4gIFxuICAgIF9oYW5kbGVMaWtlQnV0dG9uKCl7XG4gICAgICBpZighdGhpcy5fZGF0YS5pc0xpa2VkKXtcbiAgICAgICAgYXBpLmFkZExpa2UodGhpcy5fZGF0YS5faWQsIHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fZGF0YS5pc0xpa2VkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZXtcbiAgICAgICAgYXBpLmRlbGV0ZUxpa2UodGhpcy5fZGF0YS5faWQsIHRoaXMuX2NhcmRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fZGF0YS5pc0xpa2VkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICBcbiAgICByZXR1cm5DYXJkRWxlbWVudCgpe1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJykuc3JjID0gdGhpcy5fZGF0YS5saW5rO1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLm5hbWU7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKS5hbHQgPSB0aGlzLl9kYXRhLm5hbWU7XG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICBcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgICB9XG4gIH0iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJ1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0IFBvcHVwV2l0aFllcyBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aFllcy5qcyc7XG5pbXBvcnQgeyB2YWxpZGF0aW9uQ29uZmlnLCBjYXJkVGVtcGxhdGUgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7aW1hZ2VQb3B1cCwgdXNlckluZm9Qb3B1cCwgYWRkUGxhY2VQb3B1cCwgdXNlckluZm8sIGF2YXRhclBvcHVwIH0gZnJvbSAnLi4vcGFnZXMvaW5kZXguanMnO1xuXG5mdW5jdGlvbiB2aWV3UGxhY2VJbWFnZShkYXRhKXtcbiAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YSlcbiAgfVxuICBcbmZ1bmN0aW9uIG1ha2VQb3BVcFZpc2libGUoKXtcbiAgICB1c2VySW5mb1BvcHVwLm9wZW4oKTtcbiAgICB1c2VySW5mb1BvcHVwLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xufVxuICBcbmZ1bmN0aW9uIG1ha2VBZGRQbGFjZVBvcFVwVmlzaWJsZSgpe1xuICAgIGFkZFBsYWNlUG9wdXAub3BlbigpO1xufVxuXG5mdW5jdGlvbiBtYWtlQXZhdGFyUG9wVXBWaXNpYmxlKCl7XG4gICAgYXZhdGFyUG9wdXAub3BlbigpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVOZXdVc2VySW5mbyhuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yKXtcbiAgICByZXR1cm4gbmV3IFVzZXJJbmZvKHtuYW1lU2VsZWN0b3I6IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3I6IGpvYlNlbGVjdG9yfSlcbn1cbiAgXG5mdW5jdGlvbiBjcmVhdGVGb3JtVmFsaWRhdG9yKG1vZGFsRm9ybSl7XG4gICAgcmV0dXJuIG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIG1vZGFsRm9ybSk7XG59XG4gIFxuZnVuY3Rpb24gY3JlYXRlUG9wdXBXaXRoRm9ybShwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KXtcbiAgICByZXR1cm4gbmV3IFBvcHVwV2l0aEZvcm0oe3BvcHVwU2VsZWN0b3I6IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZUZvcm1TdWJtaXR9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUG9wdXBXaXRoWWVzKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVllc0J1dHRvbil7XG4gICAgcmV0dXJuIG5ldyBQb3B1cFdpdGhZZXMgKHtwb3B1cFNlbGVjdG9yOiBwb3B1cFNlbGVjdG9yLCBoYW5kbGVZZXNCdXR0b246IGhhbmRsZVllc0J1dHRvbn0pO1xufVxuICBcbmZ1bmN0aW9uIGNyZWF0ZVBvcHVwV2l0aEltYWdlKHBvcHVwU2VsZWN0b3Ipe1xuICAgIHJldHVybiBuZXcgUG9wdXBXaXRoSW1hZ2Uoe3BvcHVwU2VsZWN0b3I6IHBvcHVwU2VsZWN0b3J9KTtcbn1cbiAgXG5mdW5jdGlvbiBjcmVhdGVOZXdDYXJkKGl0ZW0pe1xuICAgIHJldHVybiBuZXcgQ2FyZChpdGVtLCBjYXJkVGVtcGxhdGUsIHZpZXdQbGFjZUltYWdlKS5yZXR1cm5DYXJkRWxlbWVudCgpO1xufVxuXG5leHBvcnQge21ha2VQb3BVcFZpc2libGUsIG1ha2VBZGRQbGFjZVBvcFVwVmlzaWJsZSwgY3JlYXRlTmV3VXNlckluZm8sIGNyZWF0ZUZvcm1WYWxpZGF0b3IsIGNyZWF0ZVBvcHVwV2l0aEZvcm0sIGNyZWF0ZVBvcHVwV2l0aEltYWdlLCBjcmVhdGVOZXdDYXJkLCBjcmVhdGVQb3B1cFdpdGhZZXMsIG1ha2VBdmF0YXJQb3BVcFZpc2libGV9OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwe1xuICAgIGNvbnN0cnVjdG9yKHtwb3B1cFNlbGVjdG9yfSl7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgb3Blbigpe1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKXtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICAgICAgaWYoZXZ0LmtleT09PSdFc2NhcGUnKXtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9oYW5kbGVSZW1vdGVDbGljayhldnQpe1xuICAgICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHsgXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpe1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZS1idXR0b24tY29udGFpbmVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVJlbW90ZUNsaWNrKGV2dCk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwe1xuICAgIGNvbnN0cnVjdG9yKHtwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0fSl7XG4gICAgICAgIHN1cGVyKHtwb3B1cFNlbGVjdG9yfSk7XG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Zvcm0nKTtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbF9faW5wdXQnKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgfVxuXG4gICAgY2xvc2UoKXtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCl7XG4gICAgICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQuaWRdID0gaW5wdXQudmFsdWU7XG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XG4gICAgfVxuXG4gICAgc2V0SW5wdXRWYWx1ZXMoZGF0YSl7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0LmlkXTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpe1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoWWVzIGV4dGVuZHMgUG9wdXB7XG4gICAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3IsIGhhbmRsZVllc0J1dHRvbn0pe1xuICAgICAgICBzdXBlcih7cG9wdXBTZWxlY3Rvcn0pO1xuICAgICAgICB0aGlzLl9oYW5kbGVZZXNCdXR0b24gPSBoYW5kbGVZZXNCdXR0b247XG4gICAgICAgIHRoaXMuX3BvcHVwQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYnV0dG9uJylcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpe1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVZZXNCdXR0b24oKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbntcbiAgICBjb25zdHJ1Y3Rvcih7aXRlbXMsIHJlbmRlcmVyfSwgY2xhc3NTZWxlY3Rvcil7XG4gICAgICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKCl7XG4gICAgICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgYXBwZW5kSXRlbShuZXdJdGVtKXtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChuZXdJdGVtKTtcbiAgICB9XG5cbiAgICBwcmVwZW5kSXRlbShuZXdJdGVtKXtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQobmV3SXRlbSk7XG4gICAgfVxufSIsIi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICAgREVDTEFSSU5HIFZBUklBQkxFUyAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuLy9JTVBPUlRTXG5pbXBvcnQgJy4vaW5kZXguY3NzJztcbmltcG9ydCB7ZWRpdEJ1dHRvbiwgcHJvZmlsZU5hbWVDbGFzcywgcHJvZmlsZURlc2NyaXB0aW9uQ2xhc3MsIGFkZFBsYWNlQnV0dG9uLCBjYXJkTW9kYWxGb3JtLCBwcm9maWxlTW9kYWxGb3JtLCBhdmF0YXJNb2RhbEZvcm0sIGF2YXRhckJ1dHRvbn0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCB7bWFrZVBvcFVwVmlzaWJsZSwgbWFrZUFkZFBsYWNlUG9wVXBWaXNpYmxlLCBjcmVhdGVOZXdVc2VySW5mbywgY3JlYXRlRm9ybVZhbGlkYXRvciwgY3JlYXRlUG9wdXBXaXRoRm9ybSwgY3JlYXRlUG9wdXBXaXRoSW1hZ2UsIG1ha2VBdmF0YXJQb3BVcFZpc2libGV9IGZyb20gJy4uL3V0aWxzL3V0aWxzLmpzJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGkuanMnXG5cblxuY29uc3QgYXBpID0gbmV3IEFwaSgpO1xuYXBpLmxvYWRVc2VySW5mbygpO1xuYXBpLmxvYWRDYXJkcygpO1xuXG5cbi8vU1RPUklORyBDTEFTUyBJTlNUQU5DRVNcbmNvbnN0IGltYWdlUG9wdXAgPSBjcmVhdGVQb3B1cFdpdGhJbWFnZSgnI2NhcmQtbW9kYWwnKTtcbmNvbnN0IHVzZXJJbmZvID0gY3JlYXRlTmV3VXNlckluZm8ocHJvZmlsZU5hbWVDbGFzcywgcHJvZmlsZURlc2NyaXB0aW9uQ2xhc3MpO1xuY29uc3QgZm9ybVZhbGlkYXRvclByb2ZpbGVNb2RhbCA9IGNyZWF0ZUZvcm1WYWxpZGF0b3IocHJvZmlsZU1vZGFsRm9ybSk7XG5jb25zdCBmb3JtVmFsaWRhdG9yQ2FyZE1vZGFsID0gY3JlYXRlRm9ybVZhbGlkYXRvcihjYXJkTW9kYWxGb3JtKTtcbmNvbnN0IGZvcm1WYWxpZGF0b3JBdmF0YXJNb2RhbCA9IGNyZWF0ZUZvcm1WYWxpZGF0b3IoYXZhdGFyTW9kYWxGb3JtKTtcbmNvbnN0IGFkZFBsYWNlUG9wdXAgPSBjcmVhdGVQb3B1cFdpdGhGb3JtKCcjYWRkLWNhcmQtbW9kYWwnLCAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgYXBpLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaS5hZGROZXdDYXJkKGlucHV0VmFsdWVzKTtcbn0pO1xuY29uc3QgdXNlckluZm9Qb3B1cCA9IGNyZWF0ZVBvcHVwV2l0aEZvcm0oJyNwcm9maWxlLW1vZGFsJywgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGFwaS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGkuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMpO1xufSk7XG5jb25zdCBhdmF0YXJQb3B1cCA9IGNyZWF0ZVBvcHVwV2l0aEZvcm0oJyNhdmF0YXItbW9kYWwnLCAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgYXBpLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaS51cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcyk7XG59KVxuXG5cblxuXG5cbi8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICAgRVZFTlQgTElTVEVORVJTICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5mb3JtVmFsaWRhdG9yUHJvZmlsZU1vZGFsLmVuYWJsZVZhbGlkYXRpb24oKTtcbmZvcm1WYWxpZGF0b3JDYXJkTW9kYWwuZW5hYmxlVmFsaWRhdGlvbigpO1xuZm9ybVZhbGlkYXRvckF2YXRhck1vZGFsLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZFBsYWNlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnVzZXJJbmZvUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsgXG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpOyBcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBtYWtlUG9wVXBWaXNpYmxlKTtcbmFkZFBsYWNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbWFrZUFkZFBsYWNlUG9wVXBWaXNpYmxlKTtcbmF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG1ha2VBdmF0YXJQb3BVcFZpc2libGUpO1xuXG5leHBvcnQge2ltYWdlUG9wdXAsIHVzZXJJbmZvUG9wdXAsIGFkZFBsYWNlUG9wdXAsIHVzZXJJbmZvLCBhdmF0YXJQb3B1cCwgYXBpfTsiLCJpbXBvcnQgU2VjdGlvbiBmcm9tICcuL1NlY3Rpb24uanMnO1xuaW1wb3J0IHtjcmVhdGVOZXdDYXJkfSBmcm9tICcuLi91dGlscy91dGlscy5qcyc7XG5pbXBvcnQge2NhcmRDb250YWluZXJDbGFzc30gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IHVzZXJJbmZvIH0gZnJvbSAnLi4vcGFnZXMvaW5kZXguanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcGl7XG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSAnaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEnLFxuICAgICAgdGhpcy5faGVhZGVycyA9IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0YzQ1ZDk4OS1lMWFhLTRiYjYtYTQ2Ny02YWM5YzQ2ZjNkYWNcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH07XG4gICAgICB0aGlzLl9oZWFkZXJzMSA9IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0YzQ1ZDk4OS1lMWFhLTRiYjYtYTQ2Ny02YWM5YzQ2ZjNkYWNcIixcbiAgICAgIH1cbiAgICB9XG4gIFxuICAgIGxvYWRVc2VySW5mbygpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzMVxuICAgICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmKHJlcy5vayl7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH0gZWxzZXtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICB9XG4gIFxuICAgIGxvYWRDYXJkcygpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzMVxuICAgICAgfSlcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmKHJlcy5vayl7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH0gZWxzZXtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgY29uc3QgcmVuZGVyQ2FyZHMgPSBuZXcgU2VjdGlvbih7aXRlbXM6IGRhdGEsIHJlbmRlcmVyOiAoY2FyZEl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZU5ld0NhcmQoY2FyZEl0ZW0pO1xuICBcbiAgICAgICAgICBpZihjYXJkSXRlbS5pc0xpa2VkKXtcbiAgICAgICAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19sb3ZlLWljb24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19sb3ZlLWljb25fYmFja2dyb3VuZF9ibGFjaycpO1xuICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19sb3ZlLWljb24nKS5jbGFzc0xpc3QucmVtb3ZlKCdjYXJkX19sb3ZlLWljb25fYmFja2dyb3VuZF9ibGFjaycpO1xuICAgICAgICAgIH1cbiAgXG4gICAgICAgICAgcmVuZGVyQ2FyZHMuYXBwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH19LCBjYXJkQ29udGFpbmVyQ2xhc3MpO1xuICAgICAgXG4gICAgICAgIHJlbmRlckNhcmRzLnJlbmRlckl0ZW1zKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgfVxuICBcbiAgICBlZGl0UHJvZmlsZShpbnB1dFZhbHVlcyl7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoaW5wdXRWYWx1ZXMpXG4gICAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYocmVzLm9rKXtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfSBlbHNle1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC50aGVuKHZhbHVlcyA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHZhbHVlcyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHRoaXMucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KVxuICAgIH1cbiAgXG4gICAgYWRkTmV3Q2FyZChpbnB1dFZhbHVlcyl7XG4gICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbnB1dFZhbHVlcylcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZihyZXMub2spe1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4odmFsdWVzID0+IHtcbiAgICAgICAgY29uc3QgdGl0bGVWYWx1ZSA9IHZhbHVlcy5uYW1lO1xuICAgICAgICBjb25zdCB1cmxWYWx1ZSA9IHZhbHVlcy5saW5rO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVOZXdDYXJkKHtuYW1lOiB0aXRsZVZhbHVlLCBsaW5rOiB1cmxWYWx1ZSwgX2lkOiB2YWx1ZXMuX2lkfSk7XG4gICAgICBcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzJykucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gICAgICAgIGZvcm1WYWxpZGF0b3JDYXJkTW9kYWwuZGlzYWJsZVN0YXRlQnV0dG9uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHRoaXMucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICB9KVxuICAgIH1cbiAgXG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyczFcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZihyZXMub2spe1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgfVxuICBcbiAgICBhZGRMaWtlKGNhcmRJZCwgY2FyZEVsZW1lbnQpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyczFcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZihyZXMub2spe1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYocmVzLmlzTGlrZWQpe1xuICAgICAgICAgIGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19sb3ZlLWljb24nKS5jbGFzc0xpc3QuYWRkKCdjYXJkX19sb3ZlLWljb25fYmFja2dyb3VuZF9ibGFjaycpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgfVxuICBcbiAgICBkZWxldGVMaWtlKGNhcmRJZCwgY2FyZEVsZW1lbnQpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyczFcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZihyZXMub2spe1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgaWYoIXJlcy5pc0xpa2VkKXtcbiAgICAgICAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbG92ZS1pY29uJykuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbG92ZS1pY29uX2JhY2tncm91bmRfYmxhY2snKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgIH1cbiAgXG4gICAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoaW5wdXRWYWx1ZXMpe1xuICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbnB1dFZhbHVlcylcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZihyZXMub2spe1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4odmFsdWVzID0+IHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJykuc3JjID0gdmFsdWVzLmF2YXRhcjtcbiAgICAgICAgY29uc29sZS5sb2codmFsdWVzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpe1xuICAgICAgICBpZihpc0xvYWRpbmcpe1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKS50ZXh0Q29udGVudCA9ICdTYXZpbmcuLi4nO1xuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2J1dHRvbicpLnRleHRDb250ZW50ID0gJ1NhdmUnO1xuICAgICAgICB9XG4gICAgfVxuICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwe1xuICAgIG9wZW4oZGF0YSl7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlJykuc3JjID0gZGF0YS5saW5rO1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpLmFsdCA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2FwdGlvbicpLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgICBcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mb3tcbiAgICBjb25zdHJ1Y3Rvcih7bmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcn0pe1xuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fdXNlckpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCl7XG4gICAgICAgIHRoaXMuX3VzZXJJbmZvID0ge307XG5cbiAgICAgICAgdGhpcy5fdXNlckluZm9bJ25hbWUnXSA9IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50O1xuICAgICAgICB0aGlzLl91c2VySW5mb1snYWJvdXQnXSA9IHRoaXMuX3VzZXJKb2IudGV4dENvbnRlbnQ7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvO1xuICAgIH1cblxuICAgIHNldFVzZXJJbmZvKGlucHV0VmFsdWVzKXtcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBpbnB1dFZhbHVlcy5uYW1lO1xuICAgICAgICB0aGlzLl91c2VySm9iLnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuYWJvdXQ7XG4gICAgfVxufSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImVkaXRCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRQbGFjZUJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsImNhcmRNb2RhbEZvcm0iLCJwcm9maWxlTW9kYWxGb3JtIiwiYXZhdGFyTW9kYWxGb3JtIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX3ZhbGlkYXRpb25Db25maWciLCJfZm9ybUVsZW1lbnQiLCJfYnV0dG9uRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJidXR0b25FbGVtZW50IiwiZGlzYWJsZVN0YXRlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic2V0QXR0cmlidXRlIiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiX2RhdGEiLCJfY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiZGVsZXRlQ2FyZFBvcHVwIiwiUG9wdXBXaXRoWWVzIiwicG9wdXBTZWxlY3RvciIsImhhbmRsZVllc0J1dHRvbiIsImFwaSIsImRlbGV0ZUNhcmQiLCJfaWQiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIm9wZW4iLCJzZXRFdmVudExpc3RlbmVycyIsImlzTGlrZWQiLCJkZWxldGVMaWtlIiwiYWRkTGlrZSIsInJldHVybkNhcmRFbGVtZW50Iiwic3JjIiwibGluayIsIm5hbWUiLCJhbHQiLCJQb3B1cCIsIl9yZWYiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZVJlbW90ZUNsaWNrIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2lucHV0TGlzdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsIl9oYW5kbGVZZXNCdXR0b24iLCJfcG9wdXBCdXR0b24iLCJ2aWV3UGxhY2VJbWFnZSIsImltYWdlUG9wdXAiLCJjcmVhdGVGb3JtVmFsaWRhdG9yIiwibW9kYWxGb3JtIiwiY3JlYXRlUG9wdXBXaXRoRm9ybSIsImNyZWF0ZU5ld0NhcmQiLCJpdGVtIiwiU2VjdGlvbiIsImNsYXNzU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2luaXRpYWxBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFwcGVuZEl0ZW0iLCJuZXdJdGVtIiwiYXBwZW5kIiwicHJlcGVuZEl0ZW0iLCJwcmVwZW5kIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJfaGVhZGVyczEiLCJsb2FkVXNlckluZm8iLCJmZXRjaCIsImhlYWRlcnMiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJhdmF0YXIiLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsImxvYWRDYXJkcyIsInJlbmRlckNhcmRzIiwiY2FyZEl0ZW0iLCJjYXJkRWxlbWVudCIsImVkaXRQcm9maWxlIiwiaW5wdXRWYWx1ZXMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInZhbHVlcyIsImZpbmFsbHkiLCJyZW5kZXJMb2FkaW5nIiwiYWRkTmV3Q2FyZCIsImZvcm1WYWxpZGF0b3JDYXJkTW9kYWwiLCJjYXJkSWQiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImlzTG9hZGluZyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX3VzZXJOYW1lIiwiX3VzZXJKb2IiLCJnZXRVc2VySW5mbyIsIl91c2VySW5mbyIsImFib3V0IiwiZm9ybVZhbGlkYXRvclByb2ZpbGVNb2RhbCIsImZvcm1WYWxpZGF0b3JBdmF0YXJNb2RhbCIsImFkZFBsYWNlUG9wdXAiLCJ1c2VySW5mb1BvcHVwIiwiYXZhdGFyUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9